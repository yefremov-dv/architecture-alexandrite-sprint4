# Task 3
---
### Проанализируйте систему компании и C4-диаграмму в контексте планирования трейсинга.

> Напишите и выделите на схеме системы, которые следует покрыть трейсингом. Для этого идентифицируйте места, где заказ может «сломаться» или зависнуть.
Составьте список данных, которые должны попадать в трейсинг.

Проанализируем все статусы заказа и их расположение:
|Статус|Система|Возможность поломки/зависания|Данные для трейсинга|
|------|-------|-----------------------------|--------------------|
|INITIATED|Internet Shop|Высокая|Запрос на размещение заказа от клиента|
|FILE_UPLOADED|Internet Shop|Незначительная|На основе анализа пользотельских жалоб принято решение не добавлять данный показатель
|SUBMITTED|Internet Shop|Высокая|Подтверждение заказа|
|PRICE_CALCULATED|MES|Незначительная|На основе анализа пользотельских жалоб принято решение не добавлять данный показатель
|MANUFACTURING_APPROVED|CRM|Высокая|Утвержденный заказ|
|MANUFACTURING_STARTED|MES|Отсутствует|Сервис работает исправно для 100% случаев|
|MANUFACTURING_COMPLETED|MES|Отсутствует|Сервис работает исправно для 100% случаев|
|PACKAGING|MES|Отсутствует|Сервис работает исправно для 100% случаев|
|SHIPPED|MES|Высокая|Track-номер почтового отправления|
|CLOSED|CRM|Незначительная|На основе анализа пользотельских жалоб принято решение не добавлять данный показатель

В итоге команда приняла решение внедрять трейсинг по данным следующих систем:
- Internet Shop: Запрос на размещение заказа от клиента; Подтверждение заказа
- CRM: Утвержденный заказ
- MES: Track-номер почтового отправления

Отдельный трейсинг для B2B отсутствует, т.к. согласно описанному заданию любой итоговый заказ оказывается на утверждении в CRM благодаря соответствующей интеграции. Основные B2B жалобы (пользователи MES API) направлены на неполучение заказа, для такого трейсинга достаточны данные из CRM и MES, уже собираемые для B2C.

---
### Добавьте в файл раздел «Мотивация».

> Напишите здесь, почему в систему нужно добавить трейсинг и что это даст компании. Опишите возможные три-пять технические и бизнес-метрики решения, на которые повлияет внедрение трейсинга.


Трейсинг позволит:
- Увеличить конверсию в результате анализа действий клиентов, которые начали формировать заказ, но не утвердили его
- Понять, сколько заказов теряет компания по вине ИТ-инцидентов
- Определить наиболее результативных менеджеров по продажам, в результате диалога с которыми, клиенты утвеждают заказы
- Убедиться, что каждый выполненный заказ на производстве отправляется конечному клиенту
- Данные трейсинга позволят подготовиться к сезонному увеличению числа заказов благодаря использованию собранной информации в будущем аналитическом контуре (долгосрочная целевая архитектура, вне рамок планов на следующие полгода)

---
### Добавьте раздел «Предлагаемое решение».

> Опишите, как и с помощью каких технологий будет реализован трейсинг, какие компоненты нужно внедрить или доработать. Отразите компоненты и новые связи на схеме. Скачайте диаграмму контейнеров Александрита» в модели C4. Доработайте диаграмму, исходя из вашего решения: отразите на ней новые компоненты и связи. Новые элементы выделяйте красным цветом — так ревьюеру будет проще проверить вашу работу. Когда схема будет готова, добавьте ссылку на неё в раздел «Предлагаемое решение».

Для реализации трейсинга команда выбрала Jaeger с доработкой кода систем для сбора данных с помощью OpenTelemetry.

Компоненты к внедрению:
- Jaeger UI
- Jaeger DB

Компоненты к доработке:
- Internet Shop
- CRM
- MES

**Схема архитектуры** расположена в текущей директории под названием *"jewerly_c4_model_tracing.drawio"*

---
### Добавьте раздел «Компромиссы».

> Опишите, в каких случаях трейсинг не принесёт пользы или пока невозможен, или его реализация обойдётся слишком дорого.
Например, сложно заставить проприетарную систему отдавать метрики в нужном формате, может потребоваться дорогостоящая доработка.

Командой было предложено компромиссное решение: использовать трейсинг только для тех элементов ИТ-ландшафта, где вероятность поломки/зависания "высокая". Для зависаний с "незначительной" вероятностью было решено отложить внедрение трейсинга заказов.

Вероятность формировалась на основе анализа пользовательских жалоб. Команда понимает, что предложенный трейсинг не покроет 100% инцидентов, но закроет основную массу наиболее частых случаев, что уже значительно повысит удовлетворенность сервисом.

При выделении дополнительного финансирования со стороны бизнеса команда будет готова покрыть трейсингом 100% потенциальных точек зависания заказов.

---
### Проработайте аспекты безопасности.

> Опишите, какие меры для предотвращения несанкционированного доступа будут предусмотрены для системы трейсинга внутри компании и снаружи если это требуется.
Например: «Внедрение аутентификации — зайти в систему смогут только сотрудники компании с актуальной учетной записью и ролью “Поддержка”».

- Доступ к Jaeger UI и Jaeger DB будет окрыт только для сотрудников, занимающихся администрированием и/или наблюдением результатов мониторинговых систем.
- Запрещены любые интеграции к Jaeger DB, кроме тех, что отправляют данные трейсинга
- Данные трейсинга отправляются напрямую в базу Jaeger DB, без дополнительных интеграционных решений (например, RabbitMQ)

---